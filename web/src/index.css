@import "tailwindcss";
@plugin "@tailwindcss/typography";

/* Enable class-based dark mode */
@custom-variant dark (&:where(.dark, .dark *));

/* =============================================================================
 * BASE RESETS
 * ============================================================================= */

button,
[role="button"] {
	cursor: pointer;
}

/* Prevent accidental page reload from pull-to-refresh gesture on mobile */
html,
body {
	overscroll-behavior-y: contain;
}

/* CJK text wrapping: use phrase-based breaking where supported (Chrome 119+),
   fall back to anywhere for older browsers to prevent overflow */
:root {
	overflow-wrap: anywhere;
	word-break: auto-phrase;
}

/* =============================================================================
 * SEMANTIC THEME TOKENS
 *
 * All UI components use these tokens. Never hardcode colors.
 * Prefix: th- (theme)
 * ============================================================================= */

@theme inline {
	/* Font families */
	--font-sans: "Geist", system-ui, sans-serif;
	--font-mono: "Geist Mono", ui-monospace, monospace;

	/* Backgrounds */
	--color-th-bg-primary: var(--th-bg-primary);
	--color-th-bg-secondary: var(--th-bg-secondary);
	--color-th-bg-tertiary: var(--th-bg-tertiary);
	--color-th-bg-overlay: var(--th-bg-overlay);
	--color-th-overlay-hover: var(--th-overlay-hover);

	/* Text */
	--color-th-text-primary: var(--th-text-primary);
	--color-th-text-secondary: var(--th-text-secondary);
	--color-th-text-muted: var(--th-text-muted);
	--color-th-text-inverse: var(--th-text-inverse);

	/* Borders */
	--color-th-border: var(--th-border);
	--color-th-border-focus: var(--th-border-focus);

	/* Interactive / Accent */
	--color-th-accent: var(--th-accent);
	--color-th-accent-hover: var(--th-accent-hover);
	--color-th-accent-text: var(--th-accent-text);

	/* Semantic */
	--color-th-success: var(--th-success);
	--color-th-error: var(--th-error);
	--color-th-warning: var(--th-warning);

	/* Special - Code */
	--color-th-code-bg: var(--th-code-bg);
	--color-th-code-text: var(--th-code-text);

	/* Special - Chat bubbles */
	--color-th-user-bubble: var(--th-user-bubble);
	--color-th-user-bubble-text: var(--th-user-bubble-text);
	--color-th-ai-bubble: var(--th-ai-bubble);
	--color-th-ai-bubble-text: var(--th-ai-bubble-text);
}

/* =============================================================================
 * BASE FONT SETTINGS
 * ============================================================================= */

html {
	font-family: var(--font-sans);
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
}

code,
kbd,
pre,
samp {
	font-family: var(--font-mono);
}

/* =============================================================================
 * THEME: ABYSS (Default)
 *
 * 设计理念: 深海科技感
 * - 灵感: 深海探索、数据深渊、神秘科技
 * - 色调: 深蓝-青绿主调，给人沉稳而神秘的感觉
 * - 强调色: 电光青绿 (Teal/Cyan)
 * - 适合: 长时间编程、夜间使用
 * ============================================================================= */

:root,
.theme-abyss {
	/* Backgrounds - 清透的白底，微微带青色调 */
	--th-bg-primary: #f8fafb;
	--th-bg-secondary: #f0f5f7;
	--th-bg-tertiary: #e4ecef;
	--th-bg-overlay: rgba(12, 18, 32, 0.7);

	/* Overlays */
	--th-overlay-hover: rgba(0, 0, 0, 0.08);

	/* Text - 深蓝灰色调 */
	--th-text-primary: #0c1829;
	--th-text-secondary: #3d5160;
	--th-text-muted: #7c919e;
	--th-text-inverse: #f8fafb;

	/* Borders */
	--th-border: #d4e0e6;
	--th-border-focus: #0d9488;

	/* Interactive - Teal */
	--th-accent: #0d9488;
	--th-accent-hover: #0f766e;
	--th-accent-text: #ffffff;

	/* Semantic */
	--th-success: #10b981;
	--th-error: #ef4444;
	--th-warning: #f59e0b;

	/* Code */
	--th-code-bg: #e4ecef;
	--th-code-text: #134e4a;

	/* Chat bubbles */
	--th-user-bubble: #0d9488;
	--th-user-bubble-text: #ffffff;
	--th-ai-bubble: #e4ecef;
	--th-ai-bubble-text: #0c1829;
}

.dark.theme-abyss {
	/* Backgrounds - 深海蓝黑，有层次的深度感 */
	--th-bg-primary: #0c1220;
	--th-bg-secondary: #111b2c;
	--th-bg-tertiary: #1a2840;
	--th-bg-overlay: rgba(0, 0, 0, 0.8);

	/* Overlays */
	--th-overlay-hover: rgba(255, 255, 255, 0.1);

	/* Text - 冷白色调 */
	--th-text-primary: #e8f0f5;
	--th-text-secondary: #a0b8c8;
	--th-text-muted: #5a7a8f;
	--th-text-inverse: #0c1220;

	/* Borders */
	--th-border: #1e3348;
	--th-border-focus: #2dd4bf;

	/* Interactive - 发光的青绿 */
	--th-accent: #2dd4bf;
	--th-accent-hover: #5eead4;
	--th-accent-text: #042f2e;

	/* Semantic */
	--th-success: #34d399;
	--th-error: #f87171;
	--th-warning: #fbbf24;

	/* Code */
	--th-code-bg: #111b2c;
	--th-code-text: #5eead4;

	/* Chat bubbles */
	--th-user-bubble: #0f766e;
	--th-user-bubble-text: #ccfbf1;
	--th-ai-bubble: #1a2840;
	--th-ai-bubble-text: #e8f0f5;
}

/* =============================================================================
 * THEME: AURORA
 *
 * 设计理念: 极光梦幻
 * - 灵感: 北极光、宇宙星云、梦幻科技
 * - 色调: 紫-粉渐变主调，神秘而浪漫
 * - 强调色: 紫罗兰 (Violet/Purple)
 * - 适合: 创意工作、个性表达
 * ============================================================================= */

.theme-aurora {
	/* Backgrounds - 柔和的淡紫白 */
	--th-bg-primary: #fbf9fe;
	--th-bg-secondary: #f5f0fa;
	--th-bg-tertiary: #ebe3f3;
	--th-bg-overlay: rgba(21, 10, 36, 0.7);

	/* Overlays */
	--th-overlay-hover: rgba(0, 0, 0, 0.08);

	/* Text - 深紫灰 */
	--th-text-primary: #1e1228;
	--th-text-secondary: #4a3a5c;
	--th-text-muted: #6d5d80;
	--th-text-inverse: #fbf9fe;

	/* Borders */
	--th-border: #ddd2ea;
	--th-border-focus: #9333ea;

	/* Interactive - Violet (加深以满足 WCAG AA 4.5:1) */
	--th-accent: #9333ea;
	--th-accent-hover: #7e22ce;
	--th-accent-text: #ffffff;

	/* Semantic */
	--th-success: #22c55e;
	--th-error: #ef4444;
	--th-warning: #eab308;

	/* Code */
	--th-code-bg: #ebe3f3;
	--th-code-text: #6b21a8;

	/* Chat bubbles */
	--th-user-bubble: #9333ea;
	--th-user-bubble-text: #ffffff;
	--th-ai-bubble: #ebe3f3;
	--th-ai-bubble-text: #1e1228;
}

.dark.theme-aurora {
	/* Backgrounds - 深邃的紫色夜空 */
	--th-bg-primary: #150a24;
	--th-bg-secondary: #1e1030;
	--th-bg-tertiary: #2d1a48;
	--th-bg-overlay: rgba(0, 0, 0, 0.85);

	/* Overlays */
	--th-overlay-hover: rgba(255, 255, 255, 0.1);

	/* Text - 柔和的淡紫白 */
	--th-text-primary: #f3e8ff;
	--th-text-secondary: #c9a8e8;
	--th-text-muted: #7c5a9c;
	--th-text-inverse: #150a24;

	/* Borders */
	--th-border: #3d2860;
	--th-border-focus: #c084fc;

	/* Interactive - 发光紫 */
	--th-accent: #c084fc;
	--th-accent-hover: #d8b4fe;
	--th-accent-text: #1e1030;

	/* Semantic */
	--th-success: #4ade80;
	--th-error: #f87171;
	--th-warning: #facc15;

	/* Code */
	--th-code-bg: #1e1030;
	--th-code-text: #e9d5ff;

	/* Chat bubbles */
	--th-user-bubble: #7c3aed;
	--th-user-bubble-text: #f3e8ff;
	--th-ai-bubble: #2d1a48;
	--th-ai-bubble-text: #f3e8ff;
}

/* =============================================================================
 * THEME: EMBER
 *
 * 设计理念: 温暖余烬
 * - 灵感: 壁炉余烬、温暖木屋、秋日暖阳
 * - 色调: 温暖的棕-橙主调，舒适而放松
 * - 强调色: 余烬橙 (Orange)
 * - 适合: 放松编程、长时间阅读、护眼
 * ============================================================================= */

.theme-ember {
	/* Backgrounds - 温暖的奶油白 */
	--th-bg-primary: #fefcfa;
	--th-bg-secondary: #faf6f2;
	--th-bg-tertiary: #f2ebe4;
	--th-bg-overlay: rgba(28, 20, 18, 0.65);

	/* Overlays */
	--th-overlay-hover: rgba(0, 0, 0, 0.08);

	/* Text - 温暖的深棕 */
	--th-text-primary: #27201c;
	--th-text-secondary: #5c4a40;
	--th-text-muted: #7a6a5c;
	--th-text-inverse: #fefcfa;

	/* Borders */
	--th-border: #e6dbd2;
	--th-border-focus: #c2410c;

	/* Interactive - Orange (加深以满足 WCAG AA 4.5:1) */
	--th-accent: #c2410c;
	--th-accent-hover: #9a3412;
	--th-accent-text: #ffffff;

	/* Semantic */
	--th-success: #16a34a;
	--th-error: #dc2626;
	--th-warning: #ca8a04;

	/* Code */
	--th-code-bg: #f2ebe4;
	--th-code-text: #7c2d12;

	/* Chat bubbles */
	--th-user-bubble: #c2410c;
	--th-user-bubble-text: #ffffff;
	--th-ai-bubble: #f2ebe4;
	--th-ai-bubble-text: #27201c;
}

.dark.theme-ember {
	/* Backgrounds - 温暖的炭黑色 */
	--th-bg-primary: #1c1412;
	--th-bg-secondary: #261c18;
	--th-bg-tertiary: #382a24;
	--th-bg-overlay: rgba(0, 0, 0, 0.8);

	/* Overlays */
	--th-overlay-hover: rgba(255, 255, 255, 0.1);

	/* Text - 温暖的米白 */
	--th-text-primary: #f8f0e8;
	--th-text-secondary: #d4c0b0;
	--th-text-muted: #8a7468;
	--th-text-inverse: #1c1412;

	/* Borders */
	--th-border: #4a3830;
	--th-border-focus: #fb923c;

	/* Interactive - 温暖橙 */
	--th-accent: #fb923c;
	--th-accent-hover: #fdba74;
	--th-accent-text: #1c1412;

	/* Semantic */
	--th-success: #4ade80;
	--th-error: #f87171;
	--th-warning: #fbbf24;

	/* Code */
	--th-code-bg: #261c18;
	--th-code-text: #fed7aa;

	/* Chat bubbles */
	--th-user-bubble: #c2410c;
	--th-user-bubble-text: #fff7ed;
	--th-ai-bubble: #382a24;
	--th-ai-bubble-text: #f8f0e8;
}

/* =============================================================================
 * THEME: MINT
 *
 * 设计理念: 清新薄荷
 * - 灵感: 清晨露水、薄荷叶、清新自然
 * - 色调: 清新的绿白主调，干净而有活力
 * - 强调色: 青色 (Cyan) - 与 success 绿色区分
 * - 适合: 白天使用、专注工作、健康自然
 * ============================================================================= */

.theme-mint {
	/* Backgrounds - 清透的薄荷白 */
	--th-bg-primary: #f8fcfa;
	--th-bg-secondary: #f0f9f4;
	--th-bg-tertiary: #dcf5e7;
	--th-bg-overlay: rgba(6, 40, 28, 0.65);

	/* Overlays */
	--th-overlay-hover: rgba(0, 0, 0, 0.08);

	/* Text - 深翠绿灰 */
	--th-text-primary: #0a2018;
	--th-text-secondary: #2d5443;
	--th-text-muted: #4a7560;
	--th-text-inverse: #f8fcfa;

	/* Borders */
	--th-border: #c8e8d8;
	--th-border-focus: #0891b2;

	/* Interactive - Cyan (使用青色与 success 绿色区分，同时满足 WCAG AA) */
	--th-accent: #0891b2;
	--th-accent-hover: #0e7490;
	--th-accent-text: #ffffff;

	/* Semantic */
	--th-success: #10b981;
	--th-error: #ef4444;
	--th-warning: #f59e0b;

	/* Code */
	--th-code-bg: #dcf5e7;
	--th-code-text: #155e75;

	/* Chat bubbles */
	--th-user-bubble: #0891b2;
	--th-user-bubble-text: #ffffff;
	--th-ai-bubble: #dcf5e7;
	--th-ai-bubble-text: #0a2018;
}

.dark.theme-mint {
	/* Backgrounds - 深森林绿 */
	--th-bg-primary: #0a1610;
	--th-bg-secondary: #0f201a;
	--th-bg-tertiary: #1a3328;
	--th-bg-overlay: rgba(0, 0, 0, 0.8);

	/* Overlays */
	--th-overlay-hover: rgba(255, 255, 255, 0.1);

	/* Text - 薄荷白 */
	--th-text-primary: #e8f8f0;
	--th-text-secondary: #a8d4c0;
	--th-text-muted: #5a8a70;
	--th-text-inverse: #0a1610;

	/* Borders */
	--th-border: #224536;
	--th-border-focus: #22d3ee;

	/* Interactive - 明亮青色 (与 success 区分) */
	--th-accent: #22d3ee;
	--th-accent-hover: #67e8f9;
	--th-accent-text: #083344;

	/* Semantic */
	--th-success: #4ade80;
	--th-error: #f87171;
	--th-warning: #fbbf24;

	/* Code */
	--th-code-bg: #0f201a;
	--th-code-text: #a5f3fc;

	/* Chat bubbles */
	--th-user-bubble: #0e7490;
	--th-user-bubble-text: #ecfeff;
	--th-ai-bubble: #1a3328;
	--th-ai-bubble-text: #e8f8f0;
}

/* =============================================================================
 * THEME: VOID
 *
 * 设计理念: 极简虚空
 * - 灵感: 纯粹、极简、专注
 * - 色调: 纯粹的黑白灰，无杂念
 * - 强调色: 纯白/纯黑（取决于模式）
 * - 适合: 极致专注、程序员审美、纯粹主义
 * ============================================================================= */

.theme-void {
	/* Backgrounds - 纯净的白 (增加层次差异) */
	--th-bg-primary: #ffffff;
	--th-bg-secondary: #f8f8f8;
	--th-bg-tertiary: #efefef;
	--th-bg-overlay: rgba(9, 9, 11, 0.7);

	/* Overlays */
	--th-overlay-hover: rgba(0, 0, 0, 0.06);

	/* Text - 纯黑灰阶 */
	--th-text-primary: #09090b;
	--th-text-secondary: #3f3f46;
	--th-text-muted: #a1a1aa;
	--th-text-inverse: #fafafa;

	/* Borders */
	--th-border: #e4e4e7;
	--th-border-focus: #18181b;

	/* Interactive - 纯黑 */
	--th-accent: #18181b;
	--th-accent-hover: #27272a;
	--th-accent-text: #fafafa;

	/* Semantic */
	--th-success: #22c55e;
	--th-error: #ef4444;
	--th-warning: #eab308;

	/* Code */
	--th-code-bg: #efefef;
	--th-code-text: #18181b;

	/* Chat bubbles */
	--th-user-bubble: #18181b;
	--th-user-bubble-text: #fafafa;
	--th-ai-bubble: #efefef;
	--th-ai-bubble-text: #09090b;
}

.dark.theme-void {
	/* Backgrounds - 纯粹的黑 (增加层次差异) */
	--th-bg-primary: #09090b;
	--th-bg-secondary: #121214;
	--th-bg-tertiary: #1c1c1f;
	--th-bg-overlay: rgba(0, 0, 0, 0.9);

	/* Overlays */
	--th-overlay-hover: rgba(255, 255, 255, 0.1);

	/* Text - 纯白灰阶 */
	--th-text-primary: #fafafa;
	--th-text-secondary: #d4d4d8;
	--th-text-muted: #71717a;
	--th-text-inverse: #09090b;

	/* Borders */
	--th-border: #27272a;
	--th-border-focus: #fafafa;

	/* Interactive - 纯白 */
	--th-accent: #fafafa;
	--th-accent-hover: #e4e4e7;
	--th-accent-text: #09090b;

	/* Semantic */
	--th-success: #4ade80;
	--th-error: #f87171;
	--th-warning: #facc15;

	/* Code */
	--th-code-bg: #1c1c1f;
	--th-code-text: #e4e4e7;

	/* Chat bubbles */
	--th-user-bubble: #27272a;
	--th-user-bubble-text: #fafafa;
	--th-ai-bubble: #1c1c1f;
	--th-ai-bubble-text: #fafafa;
}

/* =============================================================================
 * DIFF VIEW STYLES (@git-diff-view/react)
 *
 * Font size is controlled via diffViewFontSize prop (12px mobile, 13px desktop)
 * ============================================================================= */

.diff-view-wrapper {
	font-family: var(--font-mono);
	line-height: 1.5;
}

/* Override diff-view colors to match our theme - Common styles */
.diff-tailwindcss-wrapper .diff-style-root {
	--diff-border--: var(--th-border);
	--diff-plain-content--: var(--th-bg-primary);
	--diff-plain-lineNumber--: var(--th-bg-secondary);
	--diff-plain-lineNumber-color--: var(--th-text-muted);
	--diff-expand-content--: var(--th-bg-secondary);
	--diff-expand-lineNumber--: var(--th-bg-secondary);
	--diff-expand-lineNumber-color--: var(--th-text-muted);
	--diff-empty-content--: var(--th-bg-secondary);
	--diff-hunk-content--: var(--th-bg-tertiary);
	--diff-hunk-lineNumber--: var(--th-bg-tertiary);
	--diff-hunk-content-color--: var(--th-text-muted);
}

/* Light mode - subtle colors for light backgrounds */
.diff-tailwindcss-wrapper[data-theme="light"] .diff-style-root {
	--diff-add-content--: color-mix(
		in srgb,
		var(--th-success) 12%,
		var(--th-bg-primary)
	);
	--diff-add-lineNumber--: color-mix(
		in srgb,
		var(--th-success) 18%,
		var(--th-bg-secondary)
	);
	--diff-add-content-highlight--: color-mix(
		in srgb,
		var(--th-success) 25%,
		var(--th-bg-primary)
	);
	--diff-del-content--: color-mix(
		in srgb,
		var(--th-error) 12%,
		var(--th-bg-primary)
	);
	--diff-del-lineNumber--: color-mix(
		in srgb,
		var(--th-error) 18%,
		var(--th-bg-secondary)
	);
	--diff-del-content-highlight--: color-mix(
		in srgb,
		var(--th-error) 25%,
		var(--th-bg-primary)
	);
}

/* Dark mode - slightly stronger colors for dark backgrounds */
.diff-tailwindcss-wrapper[data-theme="dark"] .diff-style-root {
	--diff-add-content--: color-mix(
		in srgb,
		var(--th-success) 15%,
		var(--th-bg-primary)
	);
	--diff-add-lineNumber--: color-mix(
		in srgb,
		var(--th-success) 20%,
		var(--th-bg-secondary)
	);
	--diff-add-content-highlight--: color-mix(
		in srgb,
		var(--th-success) 30%,
		var(--th-bg-primary)
	);
	--diff-del-content--: color-mix(
		in srgb,
		var(--th-error) 15%,
		var(--th-bg-primary)
	);
	--diff-del-lineNumber--: color-mix(
		in srgb,
		var(--th-error) 20%,
		var(--th-bg-secondary)
	);
	--diff-del-content-highlight--: color-mix(
		in srgb,
		var(--th-error) 30%,
		var(--th-bg-primary)
	);
}

/* Mobile: Let line numbers scroll with content instead of staying fixed */
/* biome-ignore lint/correctness/noUnknownFunction: Tailwind CSS v4 theme() function */
@media (width < theme(--breakpoint-sm)) {
	.diff-tailwindcss-wrapper .sticky {
		/* biome-ignore lint/complexity/noImportantStyles: Override library's inline sticky positioning */
		position: static !important;
	}
}

/* Let parent container handle scrolling instead of child components' internal scroll */
.diff-table-scroll-container,
.shiki {
	/* biome-ignore lint/complexity/noImportantStyles: Override library's scroll container */
	overflow-x: visible !important;
	/* biome-ignore lint/complexity/noImportantStyles: Override library's scroll container */
	overflow-y: visible !important;
}

/* =============================================================================
 * SHIKI CODE BLOCKS
 *
 * Font size is controlled via style prop in CodeHighlighter (12px mobile, 13px desktop)
 * ============================================================================= */

.shiki {
	min-width: fit-content;
	line-height: 1.5;
	/* biome-ignore lint/complexity/noImportantStyles: Override Shiki's inline background color */
	background-color: var(--th-code-bg) !important;
}
